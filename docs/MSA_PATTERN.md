## MSA 패턴
- 서비스 검색
- 에지 서버
- 리액티브 마이크로서비스
- 구성 중앙화
- 로그 분석 중앙화
- 분산 추적
- 서킷 브레이커
- 제어 루프
- 모니터링 및 경고 중앙화

### 서비스 검색
#### 문제점
- 클라이언트는 마이크로서비스, 인스턴스를 찾아야 한다.
#### 해결책
- 클라이언트 측 라우팅 > 서비스 검색 및 통신 라이브러리 사용
- 서버 측 라우팅 > 리버스 프록시를 구축후 인스터스로 전달
#### 기술
- Spring Cloud - 넷플릭스 유레카, 리본
- 쿠버네티스 - kube-proxy 서비스, 리소스

### 에지 서버
#### 문제점
- 마이크로서비스를 접근과 보호하는 방법이 필요하다. 
#### 해결책
- 에지 서버에서 허용하는 외부 요청만 마이크로 서비스로 라우팅
- 표준 프로토콜, OAuth, OIDC< JWT, API 키를 통해
  클라이언트에 대한 접근 보호 강화
#### 기술
- Spring Cloud - 스프링 시큐리티
- 쿠버네티스 - 인그레스 컨트롤러
- 이스티오 - 이스티오의 인그레스 게이트웨이

### 리액티브 마이크로서비스
#### 문제점
- 블로킹 IO는 요청수 증가시 응답 시간이 늦어지고<br> 서버 중단이 발생한다.
#### 해결책
- `비동기 메시지 프로그래밍`으로 해결<br> 메시지를 보낸 후, 수신자가 메시지를 처리하길 기다리지 않음
- `리액티브` 프레임워크 활용
- 탄력성 있는 서비스 구성
#### 기술
- Spring Boot - 스프링 리액터, 스프링 웹플럭스

### 구성 중앙화
#### 문제점
- 관리자가 관리를 위해서 구성 정보 확인이 편해야 한다
- 마이크로서비스 정보 변경에 대한 관리가 필요
#### 해결책
- 서버 애플리케이션에서 환경 구성정보를 관리
#### 기술
- Spring Cloud - Spring Config 서버
- 쿠버네티스 - 컨피그 맵, 시크릿

### 로그 분석 중앙화
#### 문제점
- 각 MSA 로그를 중앙 시스템에서 관리 방안 필요
- 발생한 이슈를 확인하려면<br> MSA 인스턴스에 접근하여 확인하는 방안 필요
#### 해결책
- 로그 이벤트를 검색한 형식으로 중앙 데이테베이스에 구성
- 로그 이벤트 조회, 분석 API, 도구를 활용
#### 기술
- 쿠버네티스 - 엘라스틱 서치, 플루언티드, 키바나

### 분산 추적
#### 문제점
- 다른 서비스와 관련된 문제가 발생한 경우 추적이 가능하여야 한다.
#### 해결책
- 다른 서비스 요청시 로그에 서비스간 ID를 넘겨서 추적해야한다.
#### 기술
- Spring Cloud - 슬루스, 집킨
- 이스티오 - 예거

### 서킷 브레이커
#### 문제점
- 하나의 서비스에서 응답하지 않으면<br> 
  마이크로서비스의 클라이언트 또한 클라이언트 요청에 답하지 않음
#### 해결책
- 문제발생시 timeout 무시하고 바로 실패하도록 서킷 발생
- 장애 복구용 프로브를 사용한다.
#### 기술
- Spring Cloud - Resilience4j
- 이스티오 - 이상감지

### 제어 루프
#### 문제점
- 지연되는 마이크로서비스 인스턴스를 수동으로<br>
  감지하고 대처하는 방법 필요
#### 해결책
- 시스템 환경 상태를 관측하는 컴포넌트 추가 <br>
  `쿠버네티스` `Discovery Registry`
#### 기술
- 쿠버네티스 컨트롤러 매니저

### 모니터링 및 경고 중앙화
#### 문제점
- 응답 시간, 자원 사용량 분석이 필요하다.
#### 해결책
- 모든 서버 메트릭 수집이 필요
  `Grafana` `Prometheus`
#### 기술
- 쿠버네티스 - `Grafana` `Prometheus`
- 이스티오 - 키알리 `Grafana` `Prometheus`



